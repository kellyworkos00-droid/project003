<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OpenERP-MVP â€” Contacts</title>
    <style>
      body { font-family: system-ui, sans-serif; margin: 20px; }
      h1 { margin-bottom: 0.25rem; }
      .row { display: flex; gap: 8px; margin: 8px 0; }
      input { padding: 6px; }
      button { padding: 6px 10px; cursor: pointer; }
      table { border-collapse: collapse; margin-top: 16px; width: 100%; }
      th, td { border: 1px solid #ddd; padding: 8px; }
      th { background: #f7f7f7; }
    </style>
  </head>
  <body>
    <h1>Contacts</h1>
    <small>Backend must be running at http://127.0.0.1:8000</small>

    <div class="row">
      <input id="name" placeholder="Name" />
      <input id="email" placeholder="Email" />
      <input id="phone" placeholder="Phone" />
      <input id="company" placeholder="Company" />
      <button id="create">Create</button>
    </div>

    <table>
      <thead>
        <tr><th>ID</th><th>Name</th><th>Email</th><th>Phone</th><th>Company</th></tr>
      </thead>
      <tbody id="rows"></tbody>
    </table>

    <script>
      const api = 'http://127.0.0.1:8000';

      async function load() {
        const res = await fetch(`${api}/contacts/`);
        const data = await res.json();
        const rows = document.getElementById('rows');
        rows.innerHTML = data.map(c => `
          <tr>
            <td>${c.id}</td>
            <td>${c.name || ''}</td>
            <td>${c.email || ''}</td>
            <td>${c.phone || ''}</td>
            <td>${c.company || ''}</td>
          </tr>
        `).join('');
      }

      async function create() {
        const payload = {
          name: document.getElementById('name').value,
          email: document.getElementById('email').value || null,
          phone: document.getElementById('phone').value || null,
          company: document.getElementById('company').value || null,
        };
        await fetch(`${api}/contacts/`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
        document.getElementById('name').value = '';
        document.getElementById('email').value = '';
        document.getElementById('phone').value = '';
        document.getElementById('company').value = '';
        await load();
      }

      document.getElementById('create').addEventListener('click', create);
      load();
    </script>
  </body>
</html>
